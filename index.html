<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="generator" content="Jetpat Spot">
  <title>Jetpat Spot</title>

  <!-- Place favicon.ico in the `app/` directory -->

  <!-- Chrome for Android theme color -->
  <meta name="theme-color" content="#2E3AA1">

  <!-- Web Application Manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- Tile color for Win8 -->
  <meta name="msapplication-TileColor" content="#3372DF">

  <!-- Add to homescreen for Chrome on Android -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="PSK">
  <link rel="icon" sizes="192x192" href="images/touch/chrome-touch-icon-192x192.png">

  <!-- Add to homescreen for Safari o niOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Jetpat Spot">
  <link rel="apple-touch-icon" href="images/touch/apple-touch-icon.png">

  <!-- Tile icon for Win8 (144x144) -->
  <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">

  <!-- build:css styles/main.css -->
  <link rel="stylesheet" href="styles/main.css">
  <!-- endbuild-->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAFpLQubdVAmdQ8rdisgjGX64cgGpEnWrM"></script>
  <script type = "text/javascript" src = "https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>


  <!-- build:js bower_components/webcomponentsjs/webcomponents-lite.min.js -->
  <script src="bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <!-- endbuild -->

<!-- mobile check -->
<script type = "text/javascript">
   $(document).ready(function(){
      window.mobilecheck = function() {
  var check = false;
  (function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))check = true})(navigator.userAgent||navigator.vendor||window.opera);
  return check;
}

  });

</script> 

  <!-- Because this project uses vulcanize this should be your only html import
       in this file. All other imports should go in elements.html -->
<link rel="import" href="elements/elements.html">
</head>

<body unresolved>
 <style>
  .yellow-button {
  text-transform: none;
  color: #eeff41;
  float: right;
  padding-top: 0px;
  padding-bottom: 0px;

  }
</style>
  <!-- build:remove -->
  <span id="browser-sync-binding"></span>
  <!-- endbuild -->

  <template is="dom-bind" id="app">
      <!-- Main Area -->
      <paper-scroll-header-panel main id="headerPanelMain" >
        <!-- Main Toolbar -->
        <paper-toolbar id="mainToolbar" class="flex">
          <span class="space"></span>
          <paper-icon-button id="id_1" icon="icons:account-circle"></paper-icon-button>
          <div id="usernameico">user</div>
          <paper-tooltip for="id_1" offset="0">Username</paper-tooltip>
          <!-- Application name -->
         

          <div class="middle middle-container">
         
            <div class="app-name">Jetpat Spot</div>
                      </div>
        </paper-toolbar>

        <!-- Main Content -->
<div class="content" style="height: 550px;">
  <paper-material elevation="1">
          <h2>Customer Details</h2>
            <paper-input label="Customer Name" id="cname" autofocus auto-validate error-message="customer name is required!"  required></paper-input>
            <paper-input label="Contact person Name" id="ccontact" auto-validate error-message="contact person name is required!" required></paper-input>
            <paper-textarea label="Remarks" rows="3" id="remarks" cols="50" required></paper-textarea>
            <br>
            <div id="location" ></div>
            <div align="center" >
            <paper-button raised style="background-color: #3f51b5;color: #f1f8e9;"  onclick="geoFindMe();"><iron-icon icon="icons:room"></iron-icon>&nbsp; Tap to get current location</paper-button>
            </div>
            <paper-button raised style="margin:60px;display:block;background-color: #3f51b5;color: #f1f8e9;"  onclick="senddat();">Submit</paper-button>
  </paper-material>

   <paper-dialog id="animated" entry-animation="scale-up-animation" exit-animation="fade-out-animation" with-backdrop modal>
              <h2 >Enter Username</h2>
             <paper-input label="username" id="username" name="username" auto-validate error-message="Please enter username!" required></paper-input>
              <div class="buttons">
            <paper-button dialog-confirm onclick="setlocal();toastset.toggle();cname.focus();" >Enter</paper-button>
            </div>
  </paper-dialog>

   <paper-toast class="fit-bottom" id="toast1" text="">
  <paper-button onclick="toast1.toggle()" class="yellow-button">OK!</paper-button>
  </paper-toast>

  <paper-toast class="fit-bottom" id="toast2" text="">
  <paper-button onclick="toast2.toggle()" class="yellow-button">OK!</paper-button>
  </paper-toast>

  <paper-toast class="fit-bottom" id="toastset" text="Username stored successfully !">
  </paper-toast>
 </div>

<script type="text/javascript">
var uname;
var geoFindMe;
var address;
var latlng={};
function setlocal() {
 uname=document.getElementById("username").value;
 localStorage.setItem("username", uname);
 localStorage.setItem("deviceid", "8csdw3323");
 uname=localStorage.getItem("username");
 geoFindMe();
}


function geoFindMe() {
  var loc = document.getElementById("location");
   document.getElementById("usernameico").innerHTML=localStorage.getItem("username");

  var geocoder = new google.maps.Geocoder;
  
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(function(position) {
           latlng.lat=position.coords.latitude;
           latlng.lng=position.coords.longitude;
           console.log(latlng);
               console.log("found you");
              geocoder.geocode({'location': latlng}, function(results, status) 
              {
                  if (status === 'OK')
                  {
                      if (results[1])
                      {
                        address=results[1].formatted_address;
                        loc.innerHTML = "<p><b>Location</b> : "+results[1].formatted_address+"</p>";
                        document.getElementById("toast1").text="Location : "+results[1].formatted_address;
                        toast1.open();                          
                      } 
                      else
                      {
                        
                        document.getElementById("toast1").text="No places found ";
                        toast1.open();
                      }
                  }

                 else 
                 {
                    
                    document.getElementById("toast1").text="Geocoder failed due to:"+ status;
                    toast1.open();

                  }

            });
          }, function() 
          {
      document.getElementById("toast2").text="Please turn on GPS";
      toast2.open();

          });
        }
         else {
          // Browser doesn't support Geolocation
          document.getElementById("toast2").text="Browser doesn't support Geolocation";
          toast2.open();
        }
}
geoFindMe();

function senddat ()
 {
if (document.getElementById("cname").value && document.getElementById("ccontact").value) {
if(address!=null)
  {
         var params = {
            "device_id":"8csdw3323",
            "app_user_name":"Vignesh",
            "customer_name":"Guna and Co Retailer",
            "customer_contact":"Guna",
            "remarks":"Ok",
            // "latitude":"",
            // "longitude":"",
            "user_location":"Indra Nagar, Adyar, Chennai"
          }
          if (mobilecheck()) {
            params.device_id=mobilecheck();

          }
          console.log('sending data');
          // params.device_id=localStorage.getItem("deviceid");
          params.app_user_name=localStorage.getItem("username");
          params.customer_name=document.getElementById("cname").value;
          params.customer_contact=document.getElementById("ccontact").value;
          params.remarks=document.getElementById("remarks").value;
          // params.latitude=latlng.lat;
          // params.longitude=latlng.lng;
          params.user_location=address;
          console.log(params);

        var settings = {
          "async": true,
          "crossDomain": true,
          "url": "http://appdemo.jetpat.com/jetpat/Settings/saveFieldVisitData",
          "method": "POST",
          "headers": {
            "cache-control": "no-cache"
          },
          "data": JSON.stringify(params)
        }

        $.ajax(settings).done(function (response) {
        var result=response;
          console.log(result);
          console.log(result.message);
          if(result.message==="success")
          {
            document.getElementById("toast1").text="Successfully Updated";
            toast1.open();
          }
          else
          {
            document.getElementById("toast1").text="Failed.Please try again !";
            toast1.open();
          }
        });


  }
 else
{
  document.getElementById("toast1").text="Location not found.Turn on GPS";
  toast1.open();
}

}

 else
  {
    document.getElementById("toast1").text="Please fill mandatory fields";
    toast1.open();
  }
}
</script>          
      </paper-scroll-header-panel>
       <paper-toast id="caching-complete"
                 duration="6000"
                 text="Caching complete! This app will work offline.">
    </paper-toast>

    <!-- </paper-drawer-panel> -->
  <platinum-sw-register auto-register
                          clients-claim
                          skip-waiting
                          base-uri="bower_components/platinum-sw/bootstrap"
                          on-service-worker-installed="displayInstalledToast">
      <platinum-sw-cache default-cache-strategy="fastest"
                         cache-config-file="cache-config.json">
      </platinum-sw-cache>
    </platinum-sw-register>
  </template>

  <!-- build:js scripts/app.js -->
  <script src="scripts/app.js"></script>
  <!-- endbuild-->

</body>

</html>
